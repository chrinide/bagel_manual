.. index:: fci

.. _fci:

************************************
Full configuration interaction (FCI)
************************************

===========
Description
===========
FCI describes the wavefunction as a linear combination of Slater determinants:

.. math::
  \Psi = \sum^{N}_{i}c_{i}\Phi_{N}

This technique is good for describing systems featuring substantial dynamic correlation. The algorithm by which the coefficients are determined, the number of states to calculate are two of the most important quanties to be specified.

This FCI section is closely connected to the :ref:`casscf` method.

==================
Prerequisites
==================

A reference wavefunction generated by some kind of :ref:`hf`, :ref:`casscf`, :ref:`fci`, or :ref:`rasci`-type calculation.

============
Keywords
============


.. topic:: ``frozen``

   | **Description**: to have frozen orbitals or not.
   | **Default**: true
   | **Datatype**: bool

.. topic:: ``algorithm``
   
   | **Description**: Algorithm to be used in the determinantion of the CI coeffcients.
   | **Default**: KH.
   | **Datatype**: string
   | **Values**: 
   |    ``KH, Knowles, Handy``: use Knowles-Handy.
   |    ``HZ, Harrison, Zarrabian``: use Harrison-Zarrabian.
   |    ``Dist, parallel``: use Parallel algorithm.
   | **Recommendation**: If the active space is large and you have multiple processors, use Dist. Otherwise, use default.

.. topic:: ``charge``

   | **Description**: The electronic charge of the system.
   | **Default**:  0
   | **Datatype**: integer
   | **Values**: `any int`
   | **Recommendation**: The electronic charge of the system. 

.. topic:: ``maxiter_fci``

   | **Description**: Maximum number of iterations in FCI algorithm 
   | **Default**: 
   | **Datatype**: integer
   | **Values**: ``and integer``
   | **Recommendation**: Becareful, a common mistake is to input the value s_z and not the number of electrons.

.. topic:: ``nspin``

   | **Description**: Number of unpaired electrons. 
   | **Default**: 0
   | **Datatype**: integer
   | **Values**: ``and integer``
   | **Recommendation**: Becareful, a common mistake is to input the value s_z and not the number of electrons.

.. topic:: ``nstates``

   | **Description**: Number of states to calculate. 
   | **Default**:``must be specified``
   | **Datatype**: integer
   | **Values**: ``any positive double``
   | **Recommendation**: User dependent, calculation of multiple states are slower.

.. topic:: ``restart``

   | **Description**: Restart the calcualtion from an earlier one. 
   | **Default**: false
   | **Datatype**: boolean
   | **Values**: ``true, false``
   | **Recommendation**: Use if possible.


.. topic:: ``thresh`` or ``thresh_fci``

   | **Description**: Threshold for convergence of selected CI algorithm 
   | **Default**: 1.0e-10 
   | **Datatype**: double
   | **Values**: ``any positive double``
   | **Recommendation**: Default, reduce for greater accuracy.



=======
Example
=======
A Hartree-Fock and FCI calculation on a dioxygen molecule with a stretched bond. The HF calculation yield an energy and set of orbitals (in the hf_orbitals.molden) which are quite incorrect. This can be compared the energies and orbitals (output to fci_orbitals.molden) obtained from the FCI calculation.

Sample input
------------

.. code-block:: javascript 

   { "bagel" : [
   {
     "title" : "molecule",
     "basis" : "tzvpp",
     "df_basis" : "tzvpp-jkfit",
     "angstrom" : true,
     "geometry" : [
       { "atom" : "O",  "xyz" : [   -0.000000,     -0.000000,      1.5]},
       { "atom" : "O",  "xyz" : [   -0.000000,     -0.000000,      0.0]}
     ]
   },
   {
     "title" : "hf",
     "thresh" : 1.0e-10
   },

   { "title" : "print",
     "filename" : "hf_orbitals.molden",
     "orbitals" : true
   },

   {
     "title" : "fci",
     "algorithm" : "kh",
     "nstate" : 2
   },

   { "title" : "print",
     "filename" : "fci_orbitals.molden",
     "orbitals" : true
   }
   ]}


References
==========

+-----------------------------------------------+-----------------------------------------------------------------------+
|          Description of Reference             |                           Reference                                   | 
+===============================================+=======================================================================+
| Used for CI convergence algorithm.            | Knowles, P. J. and Handy, N. C., **111.4-5**, 315-321, Chem. Phys.    |
|                                               | Lett.  1984                                                           |        
+-----------------------------------------------+-----------------------------------------------------------------------+
| Used for CI convergence algorithm.            | Harrison, R. J. and Zarrabian, S., **158**, 5, Chem. Phys. Lett. 1989 | 
+-----------------------------------------------+-----------------------------------------------------------------------+
| General reference for CI.                     | Szabo A. and Ostlund N. S., Modern Quantum Chemistry: Introduction    |
|                                               | to Advanced Electronic Structure Theory, Dover Publications           |
+-----------------------------------------------+-----------------------------------------------------------------------+
