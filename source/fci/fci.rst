.. _ci:


***********************************
Full configuration interaction (FCI)
***********************************

===========
Description
===========
This section discusses three of the closely related configuration interaction (CI) methods available in BAGEL; non-relativistic full CI (FCI), non-relativistic restricted CI (RASCI), and 4-component relativistic CI.  These methods have many similarities, but substantial difference in their use. Accordingly, each shall be discussed in a different subsection. Note that keywords which work for one method may not work in another.

Most of the relevant code for these methods can be found in 
BAGEL/src/ci/ci (FCI) ,   
BAGEL/src/ci/ras (ras) 
BAGEL/src/ci/zfci (ZFCI) 

FCI describes the wavefunction as a linear combination of Slater determinants:

.. math::
  \Psi = \sum^{N}_{i}c_{i}\Phi_{N}

This technique is good for describing systems featuring substantial dynamic correlation. The algorithm by which the coefficients are determined can all be specified. 


==================
Pre-requisites
==================
A reference wavefunciton generated by some kind of Hartree-Fock, DFT, CASSCF, RASSCF, or CI-type calculation.

============
Keywords
============


.. topic:: ``frozen``

   | **Description**: to have frozen orbitals or not.
   | **Default**: true
   | **Datatype**: bool

.. topic:: ``algorithm``
   
   | **Description**: Algorithm to be used in the determinantion of the CI coeffcients.
   | **Default**: KH.
   | **Datatype**: string
   | **Values**: 
   |    ``KH, Knowles, Handy``: use Knowles-Handy.
   |    ``HZ, Harrison, Zarrabian``: use Harrison-Zarrabian.
   |    ``Dist, parallel``: use Parallel algorithm.
   | **Recommendation**: If the active space is large and you have multiple processors, use Dist. Otherwise, use default.

.. topic:: ``charge``

   | **Description**: The electronic charge of the system.
   | **Default**:  0
   | **Datatype**: integer
   | **Values**: `any int`
   | **Recommendation**: The electronic charge of the system. 


.. topic:: ``frozen``

   | **Description**: Sp.
   | **Default**: false.
   | **Datatype**: boolean
   | **Values**:
   |    ``TRUE``: Freeze orbitals..
   |    ``FALSE``: Do not freeze obitals.
   | **Recommendation**: Use default; no frozen orbitals. Freezing orbitals can reduce the cost, but also the accuracy of the calculation.

.. topic:: ``maxiter_fci``

   | **Description**: Maximum number of iterations in FCI algorithm 
   | **Default**: 
   | **Datatype**: integer
   | **Values**: ``and integer``
   | **Recommendation**: Becareful, a common mistake is to input the value s_z and not the number of electrons.

.. topic:: ``nspin``

   | **Description**: Number of unpaired electrons. 
   | **Default**: 0
   | **Datatype**: integer
   | **Values**: ``and integer``
   | **Recommendation**: Becareful, a common mistake is to input the value s_z and not the number of electrons.



.. topic:: ``nstates``

   | **Description**: Number of states to calculate. 
   | **Default**:``must be specified``
   | **Datatype**: integer
   | **Values**: ``any positive double``
   | **Recommendation**: User dependent, calculation of multiple states are slower.

.. topic:: ``restart``

   | **Description**: Restart the calcualtion from an earlier one. 
   | **Default**: false
   | **Datatype**: boolean
   | **Values**: ``true, false``
   | **Recommendation**: Use if possible.



.. topic:: ``thresh`` or ``thresh_fci``

   | **Description**: Threshold for convergence of selected CI algorithm 
   | **Default**: 1.0e-10 
   | **Datatype**: double
   | **Values**: ``any positive double``
   | **Recommendation**: Default, reduce for greater accuracy.



=======
Example
=======
A series of calculations for H2 with stretching bond, one set using HF and the other set using CI.
The HF energies will not describe the bond breaking correclty.

.. code-block:: javascript 

   { "bagel" : [

   {
     "title" : "molecule",
     "basis" : "tzvpp",
     "df_basis" : "tzvpp-jkfit",
     "angstrom" : false,
     "geometry" : [
       { "atom" : "H",  "xyz" : [   -0.000000,     -0.000000,      0.9000]},
       { "atom" : "H",  "xyz" : [   -0.000000,     -0.000000,      0.0]}
     ]
   },

   {
     "title" : "hf",
     "thresh" : 1.0e-10
   },

   {
     "title" : "fci",
     "algorithm" : "kh",
     "nstate" : 2
   }

   ]}


Some information about the output should also be included. This will not be entire output but enough for the reader to know their calculation worked.

.. figure:: figure/example.png
    :width: 200px
    :align: center
    :alt: alternate text
    :figclass: align-center

    This is an example of how to insert a figure. 

References
==========

+-----------------------------------------------+-----------------------------------------------------------------------+
|          Description of Reference             |                          Reference                                    | 
+===============================================+=======================================================================+
| Used for CI convergence algorithm.            | Knowles, P. J. and Handy, N. C. Chem. Phys. Lett.  1984               |
+-----------------------------------------------+-----------------------------------------------------------------------+
| Used for CI convergence algorithm.            | Harrison, R. J. and Zarrabian, S.  Chem. Phys. Lett.  1989            |
+-----------------------------------------------+-----------------------------------------------------------------------+

