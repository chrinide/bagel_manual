.. _fci:


************************************
Full configuration interaction (FCI)
************************************

===========
Description
===========
FCI describes the wavefunction as a linear combination of Slater determinants:

.. math::
  \Psi = \sum^{N}_{i}c_{i}\Phi_{N}

This technique is good for describing systems featuring substantial dynamic correlation. The algorithm by which the coefficients are determined, the number of states to calculate are two of the most important quanties to be specified.

This FCI section is closely connected to the :ref:`casscf` method.

==================
Pre-requisites
==================

A reference wavefunction generated by some kind of :ref:`hf`, :ref:`casscf`, :ref:`fci`, or :ref:`rasci`-type calculation.

============
Keywords
============


.. topic:: ``frozen``

   | **Description**: to have frozen orbitals or not.
   | **Default**: true
   | **Datatype**: bool

.. topic:: ``algorithm``
   
   | **Description**: Algorithm to be used in the determinantion of the CI coeffcients.
   | **Default**: KH.
   | **Datatype**: string
   | **Values**: 
   |    ``KH, Knowles, Handy``: use Knowles-Handy.
   |    ``HZ, Harrison, Zarrabian``: use Harrison-Zarrabian.
   |    ``Dist, parallel``: use Parallel algorithm.
   | **Recommendation**: If the active space is large and you have multiple processors, use Dist. Otherwise, use default.

.. topic:: ``charge``

   | **Description**: The electronic charge of the system.
   | **Default**:  0
   | **Datatype**: integer
   | **Values**: `any int`
   | **Recommendation**: The electronic charge of the system. 

.. topic:: ``maxiter_fci``

   | **Description**: Maximum number of iterations in FCI algorithm 
   | **Default**: 
   | **Datatype**: integer
   | **Values**: ``and integer``
   | **Recommendation**: Becareful, a common mistake is to input the value s_z and not the number of electrons.

.. topic:: ``nspin``

   | **Description**: Number of unpaired electrons. 
   | **Default**: 0
   | **Datatype**: integer
   | **Values**: ``and integer``
   | **Recommendation**: Becareful, a common mistake is to input the value s_z and not the number of electrons.

.. topic:: ``nstates``

   | **Description**: Number of states to calculate. 
   | **Default**:``must be specified``
   | **Datatype**: integer
   | **Values**: ``any positive double``
   | **Recommendation**: User dependent, calculation of multiple states are slower.

.. topic:: ``restart``

   | **Description**: Restart the calcualtion from an earlier one. 
   | **Default**: false
   | **Datatype**: boolean
   | **Values**: ``true, false``
   | **Recommendation**: Use if possible.


.. topic:: ``thresh`` or ``thresh_fci``

   | **Description**: Threshold for convergence of selected CI algorithm 
   | **Default**: 1.0e-10 
   | **Datatype**: double
   | **Values**: ``any positive double``
   | **Recommendation**: Default, reduce for greater accuracy.



=======
Example
=======
A series of calculations for H2 with stretching bond, one set using HF and the other set using CI. The HF energies will not describe the bond breaking correclty.

Sample input
------------

.. code-block:: javascript 

   { "bagel" : [

   {
     "title" : "molecule",
     "basis" : "tzvpp",
     "df_basis" : "tzvpp-jkfit",
     "angstrom" : false,
     "geometry" : [
       { "atom" : "H",  "xyz" : [   -0.000000,     -0.000000,      0.9000]},
       { "atom" : "H",  "xyz" : [   -0.000000,     -0.000000,      0.0]}
     ]
   },

   {
     "title" : "hf",
     "thresh" : 1.0e-10
   },

   {
     "title" : "fci",
     "algorithm" : "kh",
     "nstate" : 2
   }

   ]}

Sample output
-------------

.. code-block:: javascript 

     * ci vector   0, <S^2> = 0.0000, E =      -75.28621267
       2-2222-..    -0.9869448133
       2-2.22-.2     0.0722472124
       2-22.2-2.     0.0518733106
       2-2ba2-ba     0.0515088811
       2-2ab2-ab     0.0515088811

     * ci vector   1, <S^2> = 0.0000, E =      -74.84580572
       2-222b-a.     0.6892819995
       2-222a-b.     0.6892819995
       2-2a2b-ab     0.0966215491
       2-2b2a-ba     0.0966215491
       2-22ab-2.     0.0724329521
       2-22ba-2.     0.0724329521
       2-2a2b-ba     0.0684729742
       2-2b2a-ab     0.0684729742
       2-a22b-2.    -0.0532858928
       2-b22a-2.    -0.0532858928

References
==========

+-----------------------------------------------+-----------------------------------------------------------------------+
|          Description of Reference             |                           Reference                                   | 
+===============================================+=======================================================================+
| Used for CI convergence algorithm.            | Knowles, P. J. and Handy, N. C., **111.4-5**, 315-321, Chem. Phys.    |
|                                               | Lett.  1984                                                           |        
+-----------------------------------------------+-----------------------------------------------------------------------+
| Used for CI convergence algorithm.            | Harrison, R. J. and Zarrabian, S., **158**, 5, Chem. Phys. Lett. 1989 | 
+-----------------------------------------------+-----------------------------------------------------------------------+
| General reference for CI.                     | Szabo A. and Ostlund N. S., Modern Quantum Chemistry: Introduction    |
|                                               | to Advanced Electronic Structure Theory, Dover Publications           |
+-----------------------------------------------+-----------------------------------------------------------------------+
