.. _rasci:


*******
Restricted Active Space Configuration Interaction
*******

======
Description 
======

FCI is aims to describe the wavefunction as a linear combination of Slater determinants:

.. math::
  \Psi = \sum^{N}_{i}c_{i}\Phi_{N}

The basis into which the wavefunction is expanded is typically constructed by
applying excitation operators to the determinant(s) included in the ground
state wavefunction. The Restricted Active Space (RAS) method constrainst the
types of excitations which can occur resulting in a smaller basis, and ideally
a lower computational cost than that of full CI.  In RASCI as implemented in
Bagel, the user constrains the excitations by specifying three "active" spaces,
R1, R2 and R3, which are three sets of orbitals.  The determinants in the CI
expansion are obtained by exciting from R1 into R2, from R2 to R3, or between
occupied and unoccupied orbitals in R2.  The number of excitations between R1
and R2 is constrained by specifying the maximium number of holes which can
occur in R1, whilst the number of excitations between R2 and R3 is constrained
by specifying the maximium number of electrons which can occur in R2. 

 This is useful close analysis of the impact of specific
excitations on dynamic correlation effects, and also for investigating
properties which depend on only a few specific excitations (e.g., x-ray
adsorption spectra). The disadvantage is that the RASCI basis smaller than CI,
and that the active spaces must be selected with caution.



==================
Pre-requisites
==================
A reference wavefunciton generated by some kind of Hartree-Fock, DFT, CASSCF, RASSCF, or CI-type calculation.

============
Keywords
============


.. topic:: ``active``

   | DESCRIPTION: Specifies the three active spaces used to generate the funcitons in the CI expansion.
   | DEFAULT: Must be specified by user.
   | DATATYPE: Three arrays of integers (see example).
   | VALUES : Three arrays with the containing indexes which specficy the orbitals between which excitations are permitted to occur.
   | RECOMMENDATION : This is highly system dependent, and dependent on the system under investigation. It is often good to run an initial Hartree Fock calculation, visualize the resulting orbitals in Molden (see section PRINT SECTION), and pick the spaces on the basis of chemical intuition. 

.. topic:: ``space``

   | DESCRIPTION: Specifies the output states
   | DEFAULT: Must be specified by user.
   | DATATYPE : array, user input variables to
   | VALUES: One or more arrays which define a charge, spin and nstate (number of desired states with this charge and spin)
   | RECOMMENDATION : This is highly system dependent. It shold be noted that picking the correct set of states may result in bettwe convergence, and that fewer states is not always better.

.. topic:: ``max_holes``

   | DESCRIPTION: Maximum number of particles in R1.
   | DEFAULT: 0 
   | DATATYPE : integer
   | VALUES: Any integer which is possible given the initial occupation of R1 and R2..  
   | RECOMMENDATION : System dependent, note that larger values increase the number of possible configurations, and hence the cost of the calculation.


.. topic:: ``max_particles``

   | DESCRIPTION: Maximum number of particles in R3.
   | DEFAULT: 0 
   | DATATYPE : integer
   | VALUES: Any integer which is possible given the initial occupation of R2 and R3..  
   | RECOMMENDATION : System dependent, note that alrger values increase the number of possible configurations, and hence the cost of the calculation.

.. topic:: ``nspin``

   | DESCRIPTION: Specifies the number of unpaired electrons, e.g., a triplet has an nspin of 2.
   | DEFAULT: 0 
   | DATATYPE : integer
   | VALUES: Any integer.  
   | RECOMMENDATION : The spin of the states or interest. 

.. topic:: ``algorithm``
   
   | DESCRIPTION: Algorithm to be used in the determinantion of the CI coeffcients.
   | DEFAULT: KH.
   | DATATYPE: string
   | VALUES: 
   |    ``KH, Knowles, Handy``: use Knowles-Handy.
   |    ``HZ, Harrison, Zarrabian``: use Harrison-Zarrabian.
   |    ``Dist, parallel``: use Parallel algorithm.
   | RECOMMENDATION: If the active space is large and you have multiple processors, use Dist. Otherwise, use default.

.. topic:: ``charge``

   | DESCRIPTION: The electronic charge of the system.
   | DEFAULT:  0
   | DATATYPE: integer
   | VALUES: `any int`
   | RECOMMENDATION: The electronic charge of the system. 

.. topic:: ``maxiter``

   | DESCRIPTION: Maximum number of iterations in RASCI algorithm 
   | DEFAULT: 100 
   | DATATYPE: integer
   | VALUES: ``Any positive integer``
   | RECOMMENDATION: Keep as default. Whilst higher values can be experimented with, failure too converge could also indicate an issue with the reference function, active spaces, or requested states.

.. topic:: ``davidson_subspace``

   | DESCRIPTION: Maximum dimension of subspace used for Davidson diagonalization
   | DEFAULT: 20 
   | DATATYPE: integer
   | VALUES: ``Any positive integer``
   | RECOMMENDATION: In most cases  it is best to use the default. If a large number of states are being requested if may be worth increasing it.

.. topic:: ``nstate``

   | DESCRIPTION: Number of states to calculate. If set to one, it calculates the ground state.
   | DEFAULT:1
   | DATATYPE: integer
   | VALUES: ``any positive double``
   | RECOMMENDATION: User dependent, calculation of multiple states are slower.

.. topic:: ``thresh```

   | DESCRIPTION: Threshold for convergence of selected RASCI algorithm 
   | DEFAULT: 1.0e-10 
   | DATATYPE: double
   | VALUES: ``any positive double``
   | RECOMMENDATION: Default, reduce for greater accuracy.

.. topic:: ``batchsize```

   | DESCRIPTION : Number of terms from RASCI interaction to be evaluated at simulataneously.
   | DEFAULT: 512 
   | DATATYPE: integer
   | VALUES: ``any positive integer``
   | RECOMMENDATION: Default, the optimimum value willbe system dependent.




Example
=======
Possibly series of calculations for H2 with stretching bond. HF and CI . The HF energies will not describe the bond breaking correclty.

Sample input
------------

.. code-block:: javascript 

   { "bagel" : [

   {
     "title" : "molecule",
     "basis" : "sto-3g",
     "df_basis" : "svp-jkfit",
     "angstrom" : true,
     "geometry" : [
       { "atom" : "H",  "xyz" : [   -0.000000,     -0.000000,      0.9000]},
       { "atom" : "H",  "xyz" : [   -0.000000,     -0.000000,      0.0]}
     ]
   },

   {
     "title" : "hf",
     "thresh" : 1.0e-10
   },

   {
     "title" : "fci",
     "algorithm" : "parallel",
     "nstate" : 2
   }

   ]}


Some information about the output should also be included. This will not be entire output but enough for the reader to know their calculation worked.

.. figure:: figure/example.png
    :width: 200px
    :align: center
    :alt: alternate text
    :figclass: align-center

    This is an example of how to insert a figure. 

References
==========

+-----------------------------------------------+-----------------------------------------------------------------------+
|          Description of Reference             |                          Reference                                    | 
+===============================================+=======================================================================+
| Used for CI convergence algorithm.            | Knowles, N. C. Handy Chem. Phys. Lett.  J. Chem. Phys. 1984               |
+-----------------------------------------------+-----------------------------------------------------------------------+
| Used for CI convergence algorithm.            | John Doe and Jane Doe. J. Chem. Phys. 1980, 5, 120-124.               |
+-----------------------------------------------+-----------------------------------------------------------------------+

