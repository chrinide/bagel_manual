.. _ci:

***********************************
Relativistic full configuration interaction (RelFCI)
***********************************
===========
Description
===========

FCI is aims to describe the wavefunction as a linear combination of Slater determinants:

.. math::
  \Psi = \sum^{N}_{i}c_{i}\Phi_{N}

Relativistic CI differs from non-relativistic CI primarily in the Hamiltonian which is used in the diagonalization. The physical consequence of is that this accounts for spin-orbit coupling, and the associated mixing of different spin-multiplets.

 As the kind of relativstic Hamiltonian used can have a significant impact on the computational cost there are three possible options of increasing accuracy. It is  worth noting that due to the seperarte treatement of all states within the same multiplet substantial degeneracies may occur, and so it is preferable to avoid requesting only some of the states in a multiplet.


==============
Pre-requisites
==============
A reference wavefunciton generated by some kind of Hartree-Fock, DFT, CASSCF, RASSCF, or CI-type calculation.

========
Keywords
========


.. topic:: ``frozen``

   | **Description**: Sp.
   | **Default**: false.
   | **Datatype**: boolean
   | **Values**:
   |    ``TRUE``: Freeze orbitals..
   |    ``FALSE``: Do not freeze obitals.
   | **Recommendation**: Use default; no frozen orbitals. Freezing orbitals can reduce the cost, but also the accuracy of the calculation.

.. topic:: ``maxiter (overwrites maxiter_fci)``

   | **Description**: Maximum number of iterations in FCI algorithm 
   | **Default**: 
   | **Datatype**: integer
   | **Values**: ``and integer``
   | **Recommendation**: Becareful, a common mistake is to input the value s_z and not the number of electrons.

.. topic:: ``davison_subspace``

   | **Description**: Maximum number of iterations in FCI algorithm 
   | **Default**: 20
   | **Datatype**: integer
   | **Values**:
   | **Recommendation**:

.. topic:: ``thresh (overwrites thresh_fci)``

   | **Description**: Threshold for convergence of selected CI algorithm 
   | **Default**: 1.0e-10 
   | **Datatype**: double
   | **Values**: ``any positive double``
   | **Recommendation**: Default, reduce for greater accuracy.

.. topic:: ``print_thresh``

   | **Description**:
   | **Default**: 0.05
   | **Datatype**: double
   | **Values**:
   | **Recommendation**:

.. topic:: ``state``

   | **Description**:
   | **Default**: 0
   | **Datatype**: integer
   | **Recommendation**:

.. topic:: ``gaunt``

   | **Description**:
   | **Default**: 
   | **Datatype**: boolean
   | **Recommendation**:

.. topic:: ``breit``

   | **Description**:
   | **Default**:
   | **Datatype**: boolean
   | **Recommendation**:

.. topic:: ``ncore``

   | **Description**:
   | **Default**: 
   | **Datatype**: boolean
   | **Recommendation**:

.. topic:: ``norb``

   | **Description**:
   | **Default**: 
   | **Datatype**: boolean
   | **Recommendation**:

.. topic:: ``only_ints``

   | **Description**:  Used to compute integrals, print to a file, and terminate the program.
   |      This can be used to interface BAGEL to an external CASSCF solver.  
   | **Default**: false
   | **Datatype**: boolean
   | **Recommendation**:  Normally use the default value.  

.. topic:: ``spin_adapt``

   | **Description**:
   | **Default**: true
   | **Datatype**: boolean
   | **Recommendation**:

.. topic:: ``algorithm``
   
   | **Description**: Algorithm to be used in the determinantion of the CI coeffcients.
   | **Default**: KH.
   | **Datatype**: string
   | **Values**: 
   |    ``KH, Knowles, Handy``: use Knowles-Handy.
   |    ``HZ, Harrison, Zarrabian``: use Harrison-Zarrabian.
   |    ``Dist, parallel``: use Parallel algorithm.
   | **Recommendation**: If the active space is large and you have multiple processors, use Dist. Otherwise, use default.

.. topic:: ``charge``

   | **Description**: The electronic charge of the system.
   | **Default**:  0
   | **Datatype**: integer
   | **Values**: `any int`
   | **Recommendation**: The electronic charge of the system. 

.. topic:: ``nspin``

   | **Description**: Number of unpaired electrons. 
   | **Default**: 0
   | **Datatype**: integer
   | **Values**: ``and integer``
   | **Recommendation**: Becareful, a common mistake is to input the value s_z and not the number of electrons.

.. topic:: ``nstates``

   | **Description**: Number of states to calculate. 
   | **Default**:``must be specified``
   | **Datatype**: integer
   | **Values**: ``any positive double``
   | **Recommendation**: User dependent, calculation of multiple states are slower.

.. topic:: ``active``

   | **Description**:  Orbital indices for the spatial MOs that should be included in the active space.  
   | **Default**:  Frontier orbitals are used.  If a DHF reference waveunction (or Hcore guess) is used, the canonical orbitals are ordered by orbital energy, 
   |     the "nclosed" lowest-energy orbitals are set to closed, and the next "nact" are set to active.  If the reference wavefunction was 
   |     generated by CASSCF, the order of orbitals is maintained.  
   | **Datatype**: vector of integers
   | **Recommendation**:  The convergence behavior is often improved by choosing guess orbitals similar in character to your target active orbitals.  
   |     For both relativistic Hartree--Fock and CASSCF, useful tools to identify good starting orbitals include using the "pop" keyword to print 
   |     orbital population analysis and using the "moprint" module to visualize orbital densities using Gaussian cube format.  

.. topic:: ``aniso``

   | Description:  This is the key for a block in the input file which provides parameters for magnetic anisotropy analysis, in determination of g-factors and zero-field splitting parameters.  See below for details.  

.. topic:: ``restart``

   | **Description**: Restart the calcualtion from an earlier one. 
   | **Default**: false
   | **Datatype**: boolean
   | **Values**: ``true, false``
   | **Recommendation**: Use if possible.




Example
=======
Possibly series of calculations for H2 with stretching bond. HF and CI . The HF energies will not describe the bond breaking correclty.

.. code-block:: javascript 

   { "bagel" : [

   {
     "title" : "molecule",
     "basis" : "sto-3g",
     "df_basis" : "svp-jkfit",
     "angstrom" : false,
     "geometry" : [
       { "atom" : "H",  "xyz" : [   -0.000000,     -0.000000,      0.9000]},
       { "atom" : "H",  "xyz" : [   -0.000000,     -0.000000,      0.0]}
     ]
   },

   {
     "title" : "hf",
     "thresh" : 1.0e-10
   },

   {
     "title" : "fci",
     "algorithm" : "parallel",
     "nstate" : 2
   }

   ]}


Some information about the output should also be included. This will not be entire output but enough for the reader to know their calculation worked.

.. figure:: figure/example.png
    :width: 200px
    :align: center
    :alt: alternate text
    :figclass: align-center

    This is an example of how to insert a figure. 

References
==========

+-----------------------------------------------+-----------------------------------------------------------------------+
|          Description of Reference             |                          Reference                                    | 
+===============================================+=======================================================================+
| Used for CI convergence algorithm.            | Knowles, N. C. Handy Chem. Phys. Lett.  J. Chem. Phys. 1984           |
+-----------------------------------------------+-----------------------------------------------------------------------+
| Used for CI convergence algorithm.            | John Doe and Jane Doe. J. Chem. Phys. 1980, 5, 120-124.               |
+-----------------------------------------------+-----------------------------------------------------------------------+

