.. _fci:

************************************
Full configuration interaction (FCI)
************************************

===========
Description
===========

This technique is good for describing systems featuring substantial dynamical correlation. The algorithm by which the coefficients are determined and the number of states to calculate are two of the most important quantities to be specified.

This FCI section is closely connected to the :ref:`casscf` method.

==================
Prerequisites
==================

A reference wavefunction generated by a :ref:`HF <hf>`, :ref:`CASSCF <casscf>`, :ref:`FCI <fci>`, or :ref:`RASCI <rasci>` calculation.

============
Keywords
============


.. topic:: ``maxiter (or maxiter_fci)``

   | **Description:** Maximum number of iterations in the FCI algorithm.
   | **Datatype:** int
   | **Default:** 100

.. topic:: ``thresh (or thresh_fci)``

   | **Description:** Threshold for the convergence of the selected CI algorithm.
   | **Datatype:** double
   | **Default:** 1.0e-10

.. topic:: ``algorithm``

   | **Description:** FCI algorithm to be used. 
   | **Datatype:** string
   | **Values:**
   |    ``KH, Knowles, Handy``: Use Knowles-Handy.
   |    ``HZ, Harrison, Zarrabian``: Use Harrison-Zarrabian.
   |    ``Dist, parallel``: Use parallel algorithm.
   | **Default:** KH.
   | **Recommendation:** If the active space is large and you have multiple processors, use Dist. Otherwise, use default.

.. topic:: ``frozen``

   | **Description:** Freeze core orbitals. 
   | **Datatype:** bool
   | **Default:** false 

.. topic:: ``ncore``

   | **Description:** Number of frozen core orbitals. ``ncore`` overides ``frozen``. 
   | **Datatype:** int 
   | **Default:** If ``frozen`` is true, subvalence orbitals are frozen. If false, zero. 

.. topic:: ``norb``

   | **Description:** Number of correlated orbitals. Any high-energy orbitals in excess of this number will be excluded.
   | **Datatype:** int
   | **Default:** All molecular orbitals except those excluded using ncore. 

.. topic:: ``active``

   | **Description:** Orbital indices for the orbitals to be included. 
   | **Datatype:** vector<int>
   | **Default:** Frontier orbitals are used. 

.. topic:: ``charge``

   | **Description:** The total charge of the system.
   | **Datatype:** int
   | **Default:**  0

.. topic:: ``nspin``

   | **Description:** The spin multiplicity of the wavefunction (2S+1). 
   | **Datatype:** int
   | **Default:** 0

.. topic:: ``nstate``

   | **Description:** Number of states to be calculated.
   | **Datatype:** int
   | **Default:** 1

.. topic:: ``davidson_subspace``

   | **Description:**  Number of vectors retained in the limited-memory Davidson algorithm.
   | **Datatype:** int
   | **Default:** 20
   | **Recommendation:** Reduce if an insufficient amount of memory is available (do not reduce to a value lower than 3). 

.. topic:: ``nguess``

   | **Description:** Number of guess configurations 
   | **Datatype:** int 
   | **Default:** ``nstate`` 

.. topic:: ``only_ints``

   | **Description:** If true, calculates integrals and dumps to a file. This is used to interface BAGEL to an external program.
   | **Datatype:** bool
   | **Default:** false

.. topic:: ``dipoles``

   | **Description:** Calculate dipoles 
   | **Datatype:** bool
   | **Default:** false

.. topic:: ``restart``

   | **Description:** Generate binary archive files that can be used to restart a calculation.
   | **Datatype:** bool
   | **Default:** false

.. topic:: ``print_thresh``

   | **Description:** Threshold below which CI coefficients are not printed 
   | **Datatype:** double
   | **Default:** 0.05 

=======
Example
=======
A Hartree-Fock and FCI calculation on an oxygen molecule with an elongated bond. The HF calculation is a references for the FCI calculation. Please refer to :ref:`molden` for more information on the print input block.

Sample input
------------

.. code-block:: javascript

   { "bagel" : [
   {
     "title" : "molecule",
     "basis" : "cc-pvdz",
     "df_basis" : "cc-pvdz-jkfit",
     "angstrom" : true,
     "geometry" : [
       { "atom" : "O",  "xyz" : [   -0.000000,     -0.000000,      1.5]},
       { "atom" : "O",  "xyz" : [   -0.000000,     -0.000000,      0.0]}
     ]
   },
   {
     "title" : "hf"
   },

   { "title" : "print",
     "file" : "hf_orbitals.molden",
     "orbitals" : true
   },

   {
     "title" : "fci",
     "algorithm" : "kh",
     "nstate" : 2
   },

   { "title" : "print",
     "file" : "fci_orbitals.molden",
     "orbitals" : true
   }
   ]}


Sample output
-------------

.. code-block:: javascript

 ---------------------------
        FCI calculation
  ---------------------------

  Performs exactly the same way as Knowles & Handy 1984 CPL

  o alpha-beta strings
      length:           990
  o size of the space
      determinant space:  245025
      spin-adapted space: 70785

  o single displacement lists (alpha)
      length:         19800
  o single displacement lists (beta)
      length:         19800
    * Integral transformation done. Elapsed time: 0.01

     guess   0:   closed 111111.1....         open ......1.1...

  === FCI iteration ===

      0  0      -149.42414775     1.22e-03      0.39
      1  0      -149.59892712     5.67e-04      0.39
      2  0      -149.63347311     2.03e-04      0.39
      3  0      -149.63748895     9.00e-05      0.39
      4  0      -149.63852095     4.82e-05      0.39
      5  0      -149.63871658     1.67e-05      0.39
      6  0      -149.63873281     5.08e-06      0.39
      7  0      -149.63873450     1.50e-06      0.39
      8  0      -149.63873466     5.12e-07      0.39
      9  0      -149.63873468     1.74e-07      0.39
     10  0      -149.63873468     6.26e-08      0.39
     11  0      -149.63873468     2.29e-08      0.39
     12  0      -149.63873468     7.27e-09      0.39
     13  0      -149.63873468     2.02e-09      0.39
     14  0      -149.63873468     6.14e-10      0.48
     15  0      -149.63873468     2.82e-10      0.48
     16  0      -149.63873468     1.11e-10      0.65
     17  0 *    -149.63873468     3.03e-11      0.30

     * ci vector, state   0, <S^2> = -0.0000
       222222b2a...    -0.6394413743
       222222a2b...    -0.6394413743
       2222b22a2...    -0.2260112591
       2222a22b2...    -0.2260112591
       22222.b2a2..     0.0924592521
       22222.a2b2..     0.0924592521
       2222ba22ab..     0.0754268550
       2222ab22ba..     0.0754268550
       22222bba2a..    -0.0688206488
       22222aab2b..    -0.0688206488
       2222b.2a22..    -0.0675466768
       2222a.2b22..    -0.0675466768

    * METHOD: FCI                                  7.63




References
==========

+-----------------------------------------------+----------------------------------------------------------------------------------+
|          Description of Reference             |                           Reference                                              |
+===============================================+==================================================================================+
| Efficient calculation of sigma vector         | P\. J\. Knowles and N\. C\. Handy, Chem. Phys. Lett. **111**, 315 (1984).        |
+-----------------------------------------------+----------------------------------------------------------------------------------+
| Efficient calculation of sigma vector         | R\. J\. Harrison and S\. Zarrabian, Chem. Phys. Lett. **158**, 393 (1989).       |
+-----------------------------------------------+----------------------------------------------------------------------------------+
| General text on electronic structure theory   | A\. Szabo and N. S. Ostlund,                                                     |
|                                               | *Modern Quantum Chemistry: Introduction to Advanced Electronic Structure Theory* |
|                                               | (McGraw-Hill, New York, 1989).                                                   |
+-----------------------------------------------+----------------------------------------------------------------------------------+
